# 📈 市价单处理说明

## ✨ 完美支持图片中的信号格式！

### 实际信号示例
```
#MDT 市價空
第一止盈：0.01972
```

---

## 🎯 程序如何处理

### 1️⃣ 信号解析
```
✅ 交易对: MDT/USDT
✅ 方向: SHORT (做空)
✅ 入场: 市价
✅ 止盈: 0.01972
✅ 止损: 使用默认配置
```

### 2️⃣ 智能订单计划
```
📊 订单计划
━━━━━━━━━━━━━━━━━━━━
交易对: MDT/USDT
方向: SHORT
入场: 市价（实时成交）

🛑 止损: 市价 +2.0%
   (做空时，止损在成交价上方2%)

🎯 止盈点 (1 个):
  TP1: 0.01972 (100% 仓位)
   (来自信号)

📈 追踪止损: 2.0%
⚖️ 保本止损: 盈利 1.0% 后触发
```

---

## 🚀 执行流程

### 步骤1：市价开仓
```
• 交易对: MDT/USDT
• 方向: 卖出（做空）
• 订单类型: 市价单
• 仓位大小: 根据配置计算
• 成交价: 假设 0.02000 USDT
```

### 步骤2：自动设置止损
```
• 做空止损 = 成交价 × (1 + 2%)
• 止损价格 = 0.02000 × 1.02 = 0.02040
• 说明: 价格涨到0.02040时止损
```

### 步骤3：设置止盈订单
```
• TP1: 0.01972 (100%仓位)
• 说明: 价格跌到0.01972时止盈
• 盈利: (0.02000 - 0.01972) / 0.02000 = 1.4%
```

### 步骤4：激活高级功能
```
✓ 追踪止损
  • 价格下跌时，止损自动跟随
  • 始终保持2%的安全距离
  
✓ 保本止损
  • 当盈利达到1%时
  • 止损自动移到成本价
  • 实现无风险交易
```

---

## 📊 实际交易示例

### 假设成交价: 0.02000 USDT

| 阶段 | 价格 | 操作 | 说明 |
|------|------|------|------|
| 开仓 | 0.02000 | 市价做空 | 立即成交 |
| 止损设置 | 0.02040 | 止损单 | +2% |
| 止盈设置 | 0.01972 | 限价单 | 信号TP |
| 价格下跌 | 0.01980 | - | 盈利1% |
| 保本触发 | 0.01980 | 移动SL到0.02000 | 锁定成本 |
| 价格继续跌 | 0.01972 | 止盈成交 | ✅ 获利1.4% |

---

## 🎨 支持的信号格式

### ✅ 格式1：繁体中文（图片格式）
```
#MDT 市價空
第一止盈：0.01972
```

### ✅ 格式2：多个止盈
```
#BTC 市價空
第一止盈：42000
第二止盈：41000
第三止盈：40000
```

### ✅ 格式3：简体中文
```
#ETH 市价做多
第一止盈：2300
止损：2200
```

### ✅ 格式4：带止损
```
#DOGE 市价空
第一止盈：0.085
第二止盈：0.080
止损：0.095
```

### ✅ 格式5：纯市价
```
BTC 市价多
```
→ 程序会自动设置TP和SL

---

## ⚙️ 配置说明

### 市价单相关配置

在GUI中设置：
```
⚙️ 详细设置 > 🎯 止盈止损设置

默认止损: 2.0%
  • 市价单没有止损时使用
  • 基于实际成交价计算

追踪止损: 2.0%
  • 价格有利时自动跟随
  • 保护已获利润

保本止损: 触发 1.0%
  • 盈利达到1%时触发
  • 止损移到成本价
```

---

## 🔍 在GUI中测试

### 测试步骤：
```
1. 打开程序
2. 切换到 "🧪 信号测试" 标签
3. 输入信号：

#MDT 市價空
第一止盈：0.01972

4. 点击 "🔍 解析信号"
5. 查看 "📝 实时日志" 中的完整计划
```

### 预期输出：
```
INFO: ✓ 识别到交易信号
INFO: 
INFO: 📊 订单计划
INFO: ━━━━━━━━━━━━━━━━━━━━
INFO: 交易对: MDT/USDT
INFO: 方向: SHORT
INFO: 入场: 市价（实时成交）
INFO: 
INFO: 🛑 止损: 市价 +2.0%
INFO: 
INFO: 🎯 止盈点 (1 个):
INFO:   TP1: 0.01972 (100.0%)
INFO: 
INFO: 📈 追踪止损: 2.0%
INFO: ⚖️ 保本止损: 盈利 1.0% 后触发
```

---

## 💡 重要说明

### ✓ 优点
- **快速执行**: 市价单立即成交
- **信号优先**: 使用交易员的止盈价格
- **自动保护**: 止损和追踪止损自动设置

### ⚠️ 注意
- **滑点**: 市价单可能有滑点
- **成交价不确定**: 以实际成交价为准
- **止损基于成交价**: 会在成交后立即计算

### 📋 建议
1. 测试环境先测试
2. 小仓位开始
3. 关注实际成交价
4. 监控止损设置

---

## 🎯 完整功能

### 信号处理能力
✅ 繁体中文支持
✅ 简体中文支持
✅ "第一止盈"格式
✅ 中文冒号"："
✅ 市价单识别
✅ 多个止盈点

### 订单管理能力
✅ 市价/限价自动识别
✅ 止损自动计算
✅ 止盈智能分配
✅ 追踪止损
✅ 保本止损
✅ 仓位管理

---

## 📞 使用技巧

### 技巧1：先测试再启用
```
1. 在 "🧪 信号测试" 中测试
2. 确认解析正确
3. 再启用自动交易
```

### 技巧2：检查成交价
```
1. 市价单成交后
2. 查看实际成交价
3. 确认止损位置合理
```

### 技巧3：监控日志
```
1. 关注 "📝 实时日志"
2. 查看订单执行状态
3. 确认所有订单已设置
```

---

**现在可以完美处理图片中的信号了！** 🎉

