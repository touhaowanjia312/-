# 💰 统一账户余额说明

## 问题解答

**用户问题**："我的 LBANK 交易所现货余额是 0.000044，合约余额没显示啊"

## 答案

您的 **LBANK** 和 **bitget** 都使用**统一账户模式**，因此现货和合约**共用同一个余额**。

## 什么是统一账户？

统一账户（Unified Account）是现代交易所的账户管理模式：

### 传统模式（分离账户）
```
现货账户：100 USDT
合约账户：50 USDT
总计：150 USDT（但不能互相使用）
```
- ❌ 现货和合约资金分开
- ❌ 需要手动划转资金
- ❌ 资金利用率低

### 统一账户模式
```
统一账户：150 USDT
可用于：现货 + 合约 + 期权 + 理财
```
- ✅ 所有产品共用一个资金池
- ✅ 无需手动划转
- ✅ 资金利用率高
- ✅ 保证金自动计算

## 您的账户情况

### 测试结果

| 交易所 | 余额 | 模式 |
|--------|------|------|
| **bitget** | 12.85 USDT | 统一账户 |
| **LBANK** | 0.000044 USDT | 统一账户 |
| **总计** | 12.85 USDT | - |

### GUI 显示效果

点击"🔄 刷新余额"后，您会看到：

```
💰 总计: 12.85 USDT

bitget: 12.85 (统一)
LBANK: 0.000044 (统一)
```

## 统一账户的优势

1. **资金效率高**
   - 同一笔资金可以同时用于现货和合约
   - 无需预先分配资金

2. **操作简单**
   - 不需要在现货和合约账户间划转
   - 系统自动管理保证金

3. **风险管理**
   - 系统自动计算总风险
   - 统一的保证金率

## 使用统一账户的交易所

- ✅ **Binance** - 统一账户（Unified Account）
- ✅ **OKX** - 统一账户
- ✅ **Bitget** - 统一账户
- ✅ **LBANK** - 统一账户
- ⚠️ **Bybit** - 部分统一（可选）

## 如何确认账户类型

在 GUI 中点击"🔄 刷新余额"，查看显示：
- **(统一)** - 统一账户模式
- **(现货)** - 仅现货
- **(现货: xxx, 合约: xxx)** - 分离账户

## 对交易的影响

### 做合约交易时
```python
# 系统会自动从统一账户扣除保证金
账户余额: 12.85 USDT
开仓所需保证金: 2.0 USDT (杠杆20x)
剩余可用: 10.85 USDT
```

### 做现货交易时
```python
# 从同一个账户扣除
账户余额: 12.85 USDT
购买现货: 5.0 USDT
剩余可用: 7.85 USDT
```

## 注意事项

1. **保证金计算**
   - 统一账户会自动计算所有持仓的总保证金需求
   - 确保账户总余额足够支持所有持仓

2. **强平风险**
   - 所有持仓共享同一个保证金池
   - 一个持仓亏损可能影响其他持仓

3. **资金管理**
   - 虽然是统一账户，但仍需合理分配资金
   - 避免过度使用杠杆

## 修复内容

### 1. 新增功能 - `multi_exchange_client.py`

```python
def get_balance_detailed(self, account_name: str, currency: str = 'USDT'):
    """
    获取详细余额信息（现货+合约）
    返回: {'spot': xxx, 'futures': xxx, 'total': xxx}
    """
```

### 2. 新增功能 - `multi_exchange_client.py`

```python
def get_all_balances_detailed(self):
    """获取所有账户的详细余额"""
```

### 3. 更新 GUI 显示 - `gui_main.py`

- 自动检测账户类型
- 显示统一账户标记
- 对于分离账户，分别显示现货和合约余额

## 测试脚本

运行以下脚本查看详细信息：

```bash
python test_detailed_balance.py
```

## 总结

✅ **您的 LBANK 合约余额是正常的**
✅ **现货和合约共用 0.000044 USDT**
✅ **这是统一账户模式的正常表现**
✅ **GUI 现在会明确显示"(统一)"标记**

如果要做合约交易，这 0.000044 USDT 的余额太少了，建议充值更多资金。

---

**更新时间**: 2025-10-15 00:50

