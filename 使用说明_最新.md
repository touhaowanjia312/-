# 🎉 最新GUI功能说明

## ✅ 已完成的改进

### 1. 多交易所配置 ✓
- 在 "⚙️ 详细设置" 中添加了 **"🚀 打开多交易所管理界面"** 按钮
- 可以配置多个交易所账户
- 每个账户独立设置杠杆、风险参数、仓位模式

### 2. 止盈止损(TP/SL)配置 ✓
在 "⚙️ 详细设置" 中新增了完整的 TP/SL 配置区域：

#### 🎯 分批止盈设置
- **TP1**: 利润% 和 仓位%
- **TP2**: 利润% 和 仓位%
- **TP3**: 利润% 和 仓位%

**示例配置：**
```
TP1: 2% 利润, 30% 仓位
TP2: 4% 利润, 30% 仓位
TP3: 6% 利润, 40% 仓位
```

#### 🛡️ 止损设置
- **默认止损%**: 设置默认止损百分比（如 2%）

#### 📈 追踪止损
- ☑ 启用追踪止损
- **追踪止损%**: 跟踪最高价的百分比（如 2%）

#### 💰 保本止损
- ☑ 启用保本止损
- **触发盈利%**: 盈利多少后移动止损到成本价（如 1%）

### 3. 多交易所余额显示 ✓
- 点击 "🔄 刷新余额" 现在会显示所有配置账户的余额
- 自动计算总额

---

## 🎮 使用流程

### 第一步：配置多个交易所账户

1. **打开主GUI** → 点击 **"⚙️ 详细设置"** 标签
2. **向下滚动** 找到橙色按钮 **"🚀 打开多交易所管理界面"**
3. **点击打开** 多交易所管理窗口

#### 在多交易所管理窗口中：

**添加币安账户：**
```
1. 点击 "➕ 添加账户"
2. 填写：
   账户名称: 币安主账户
   交易所类型: binance
   API Key: your_key
   API Secret: your_secret
   
   ☑ 使用测试网
   ☑ 启用此账户
   
   默认杠杆: 10x
   
   仓位计算模式: 选择 "风险百分比模式"
   风险百分比: 1.0%
   默认仓位大小: 0.01
   最大仓位限制: 0.1

3. 点击 "💾 保存账户"
```

**添加OKX账户（使用固定保证金模式）：**
```
1. 再次点击 "➕ 添加账户"
2. 填写：
   账户名称: OKX测试账户
   交易所类型: okx
   API Key: okx_key
   API Secret: okx_secret
   
   默认杠杆: 20x
   
   仓位计算模式: 选择 "固定保证金模式"
   保证金金额: 200 USDT

3. 点击 "💾 保存账户"
```

**配置完成后**，左侧列表会显示所有账户。

### 第二步：配置 TP/SL 参数

回到主GUI的 **"⚙️ 详细设置"** 标签，向下滚动找到 **"🎯 止盈止损(TP/SL)设置"**：

#### 配置示例（保守型）：
```
分批止盈：
  TP1: 利润 2%, 仓位 30%
  TP2: 利润 4%, 仓位 30%
  TP3: 利润 6%, 仓位 40%

止损：
  默认止损: 2.0%

追踪止损：
  ☑ 启用追踪止损
  追踪百分比: 2.0%

保本止损：
  ☑ 启用保本止损
  触发盈利: 1.0%
```

#### 配置示例（激进型）：
```
分批止盈：
  TP1: 利润 3%, 仓位 25%
  TP2: 利润 6%, 仓位 25%
  TP3: 利润 10%, 仓位 50%

止损：
  默认止损: 3.0%

追踪止损：
  ☑ 启用追踪止损
  追踪百分比: 3.0%

保本止损：
  ☑ 启用保本止损
  触发盈利: 2.0%
```

### 第三步：测试信号

1. 切换到 **"🧪 信号测试"** 标签
2. 输入测试信号：
```
LONG BTC/USDT
Entry: 42000
Stop Loss: 41000
Take Profit: 43000, 44000, 45000
Leverage: 10x
```
3. 点击 **"🧪 测试解析"**
4. 查看解析结果

### 第四步：查看余额

1. 在左侧控制面板
2. 点击 **"🔄 刷新余额"**
3. 会显示所有配置账户的余额总计

### 第五步：启动机器人（可选）

⚠️ **注意：只有在充分配置和测试后才执行此步骤！**

1. 确保配置了 Telegram API（在详细设置中）
2. **先关闭 "启用交易"**（仅监听模式）
3. 点击 **"▶ 启动机器人"**
4. 首次运行需要在终端输入验证码

---

## 🎯 工作原理

### 当收到交易信号时：

```
收到信号: LONG BTC/USDT @ 42000

1. 自动应用你的TP/SL配置
   ✓ 入场: 42000
   ✓ 止损: 41160 (2%)
   ✓ TP1: 42840 (2%, 30%仓位)
   ✓ TP2: 43680 (4%, 30%仓位)
   ✓ TP3: 44520 (6%, 40%仓位)
   ✓ 追踪止损: 2%
   ✓ 保本止损: 盈利1%后触发

2. 在所有启用的账户执行
   币安主账户:
     • 仓位: 根据1%风险计算
     • 杠杆: 10x
   
   OKX测试账户:
     • 仓位: 200 USDT × 20x ÷ 42000
     • 杠杆: 20x

3. 自动监控和调整
   ✓ 价格上涨 → 追踪止损自动上移
   ✓ 盈利达1% → 止损移到成本价
   ✓ 达到TP1 → 自动平30%
   ✓ 达到TP2 → 再平30%
   ✓ 达到TP3 → 平剩余40%
```

---

## 📊 界面位置指南

```
主GUI窗口
├── 左侧控制面板
│   ├── 🤖 控制台
│   │   ├── 启动/停止按钮
│   │   └── 状态显示
│   ├── 📊 统计信息
│   ├── 💰 账户余额 ← 显示多账户总额
│   │   └── 🔄 刷新余额
│   ├── ⚙️ 配置
│   │   ├── 启用交易
│   │   ├── 使用测试网
│   │   └── 风险百分比
│   └── 🌓 主题切换
│
└── 右侧标签页
    ├── 📝 实时日志
    ├── 🧪 信号测试 ← 测试信号解析
    ├── 📈 交易历史
    └── ⚙️ 详细设置 ← 重点！
        ├── Telegram 配置
        ├── 交易所配置
        ├── 🎯 TP/SL设置 ← 新增！
        │   ├── 分批止盈(TP1,TP2,TP3)
        │   ├── 默认止损
        │   ├── 追踪止损
        │   └── 保本止损
        └── 💼 多交易所管理 ← 新增！
            └── 🚀 打开管理界面按钮
```

---

## 💡 常见问题

### Q1: 配置完多交易所后，余额还是显示 "--"？
**A**: 
1. 点击 "🔄 刷新余额" 按钮
2. 如果还是不显示，检查：
   - API Key 是否正确
   - 账户是否启用
   - 网络连接是否正常

### Q2: TP/SL 设置保存在哪里？
**A**: 
- 目前保存在内存中
- 重启程序后需要重新设置
- 未来版本会保存到配置文件

### Q3: 如何知道TP/SL是否生效？
**A**: 
1. 在 "📝 实时日志" 标签中查看
2. 会显示止盈止损订单的创建信息
3. 显示追踪止损的更新

### Q4: 多个交易所会同时执行吗？
**A**: 
是的！当收到信号时：
- 所有"启用"状态的账户都会执行
- 每个账户使用自己的配置参数
- 并行执行，互不影响

### Q5: 如何禁用某个交易所？
**A**: 
1. 打开多交易所管理界面
2. 在左侧列表找到要禁用的账户
3. 点击 "✏️ 编辑账户"
4. 取消勾选 "启用此账户"
5. 保存

---

## 🎉 功能总结

✅ **多交易所支持** - 同时管理多个账户  
✅ **分批止盈** - TP1, TP2, TP3 自动执行  
✅ **追踪止损** - 跟随价格自动调整  
✅ **保本止损** - 盈利后自动保护  
✅ **风险控制** - 最大亏损限制  
✅ **数据记录** - 完整的交易历史  
✅ **统计分析** - 详细的盈亏报表  

---

## 🚀 立即开始

1. **关闭当前GUI**（如果在运行）
2. **重新运行：** `python gui_main.py`
3. **打开 "⚙️ 详细设置"** 标签
4. **配置 TP/SL 参数**
5. **打开多交易所管理** 配置账户
6. **测试信号解析** 验证功能
7. **开始使用！** 🎊

---

**所有功能都已就绪！** 💪📈💰

